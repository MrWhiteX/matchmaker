"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/auth/[...nextauth]";
exports.ids = ["pages/api/auth/[...nextauth]"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "joi":
/*!**********************!*\
  !*** external "joi" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("joi");

/***/ }),

/***/ "next-auth":
/*!****************************!*\
  !*** external "next-auth" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("next-auth");

/***/ }),

/***/ "next-auth/adapters":
/*!*************************************!*\
  !*** external "next-auth/adapters" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("next-auth/adapters");

/***/ }),

/***/ "next-auth/providers":
/*!**************************************!*\
  !*** external "next-auth/providers" ***!
  \**************************************/
/***/ ((module) => {

module.exports = require("next-auth/providers");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(api)/./models/index.ts":
/*!*************************!*\
  !*** ./models/index.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"conversation\": () => (/* binding */ conversation),\n/* harmony export */   \"conversationMessage\": () => (/* binding */ conversationMessage),\n/* harmony export */   \"conversationUser\": () => (/* binding */ conversationUser),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   \"filter\": () => (/* binding */ filter),\n/* harmony export */   \"profileCheck\": () => (/* binding */ profileCheck),\n/* harmony export */   \"skill\": () => (/* binding */ skill),\n/* harmony export */   \"timezone\": () => (/* binding */ timezone),\n/* harmony export */   \"user\": () => (/* binding */ user)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nlet prisma;\n\nif (false) {} else {\n  let globalWithPrisma = global;\n\n  if (!globalWithPrisma.prisma) {\n    globalWithPrisma.prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\n  }\n\n  prisma = globalWithPrisma.prisma;\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (prisma);\nconst {\n  conversation,\n  conversationUser,\n  conversationMessage,\n  user,\n  filter,\n  skill,\n  timezone,\n  profileCheck\n} = prisma;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9tb2RlbHMvaW5kZXgudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUVBLElBQUlDLE1BQUo7O0FBRUEsSUFBSSxPQUF1QyxFQUEzQyxNQUVPO0VBQ0wsSUFBSUMsZ0JBQWdCLEdBQUdDLE1BQXZCOztFQUdBLElBQUksQ0FBQ0QsZ0JBQWdCLENBQUNELE1BQXRCLEVBQThCO0lBQzVCQyxnQkFBZ0IsQ0FBQ0QsTUFBakIsR0FBMEIsSUFBSUQsd0RBQUosRUFBMUI7RUFDRDs7RUFDREMsTUFBTSxHQUFHQyxnQkFBZ0IsQ0FBQ0QsTUFBMUI7QUFDRDs7QUFFRCxpRUFBZUEsTUFBZjtBQUVPLE1BQU07RUFDWEcsWUFEVztFQUVYQyxnQkFGVztFQUdYQyxtQkFIVztFQUlYQyxJQUpXO0VBS1hDLE1BTFc7RUFNWEMsS0FOVztFQU9YQyxRQVBXO0VBUVhDO0FBUlcsSUFTVFYsTUFURyIsInNvdXJjZXMiOlsid2VicGFjazovL01ha2VyLy4vbW9kZWxzL2luZGV4LnRzPzg2ZDciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSBcIkBwcmlzbWEvY2xpZW50XCI7XG5cbmxldCBwcmlzbWE6IFByaXNtYUNsaWVudDtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIikge1xuICBwcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KCk7XG59IGVsc2Uge1xuICBsZXQgZ2xvYmFsV2l0aFByaXNtYSA9IGdsb2JhbCBhcyB0eXBlb2YgZ2xvYmFsVGhpcyAmIHtcbiAgICBwcmlzbWE6IFByaXNtYUNsaWVudDtcbiAgfTtcbiAgaWYgKCFnbG9iYWxXaXRoUHJpc21hLnByaXNtYSkge1xuICAgIGdsb2JhbFdpdGhQcmlzbWEucHJpc21hID0gbmV3IFByaXNtYUNsaWVudCgpO1xuICB9XG4gIHByaXNtYSA9IGdsb2JhbFdpdGhQcmlzbWEucHJpc21hO1xufVxuXG5leHBvcnQgZGVmYXVsdCBwcmlzbWE7XG5cbmV4cG9ydCBjb25zdCB7XG4gIGNvbnZlcnNhdGlvbixcbiAgY29udmVyc2F0aW9uVXNlcixcbiAgY29udmVyc2F0aW9uTWVzc2FnZSxcbiAgdXNlcixcbiAgZmlsdGVyLFxuICBza2lsbCxcbiAgdGltZXpvbmUsXG4gIHByb2ZpbGVDaGVjayxcbn0gPSBwcmlzbWE7XG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwicHJpc21hIiwiZ2xvYmFsV2l0aFByaXNtYSIsImdsb2JhbCIsImNvbnZlcnNhdGlvbiIsImNvbnZlcnNhdGlvblVzZXIiLCJjb252ZXJzYXRpb25NZXNzYWdlIiwidXNlciIsImZpbHRlciIsInNraWxsIiwidGltZXpvbmUiLCJwcm9maWxlQ2hlY2siXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./models/index.ts\n");

/***/ }),

/***/ "(api)/./pages/api/auth/[...nextauth].ts":
/*!*****************************************!*\
  !*** ./pages/api/auth/[...nextauth].ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth */ \"next-auth\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_auth_providers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers */ \"next-auth/providers\");\n/* harmony import */ var next_auth_providers__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_auth_adapters__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/adapters */ \"next-auth/adapters\");\n/* harmony import */ var next_auth_adapters__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_auth_adapters__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var services_users_authorize__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! services/users/authorize */ \"(api)/./services/users/authorize.ts\");\n\n\n\n\n\nconst prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_3__.PrismaClient();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (next_auth__WEBPACK_IMPORTED_MODULE_0___default()({\n  // Configure one or more authentication providers\n  providers: [next_auth_providers__WEBPACK_IMPORTED_MODULE_1___default().GitHub({\n    clientId: process.env.GITHUB_ID,\n    clientSecret: process.env.GITHUB_SECRET,\n    scope: \"read:user, user:email\"\n  }), next_auth_providers__WEBPACK_IMPORTED_MODULE_1___default().Credentials({\n    name: \"Credentials\",\n    credentials: {\n      email: {\n        label: \"Email\",\n        type: \"text\",\n        placeholder: \"jsmith\"\n      },\n      password: {\n        label: \"Password\",\n        type: \"password\"\n      }\n    },\n\n    async authorize(credentials, req) {\n      const user = await (0,services_users_authorize__WEBPACK_IMPORTED_MODULE_4__[\"default\"])({\n        email: credentials.email,\n        password: credentials.password\n      });\n\n      if (user) {\n        return {\n          id: user.id,\n          email: user.email,\n          emailVerified: user.emailVerified,\n          name: user.name,\n          role: user.role,\n          image: user.image,\n          skill: user.skill,\n          timezone: user.timezone,\n          biogram: user.biogram,\n          createdAt: user.createdAt,\n          updatedAt: user.updatedAt\n        };\n      } else {\n        return null;\n      }\n    }\n\n  })],\n  callbacks: {\n    signIn: async (profile, account) => {\n      if (account?.provider === \"github\") {\n        const res = await fetch(\"https://api.github.com/user/emails\", {\n          headers: {\n            Authorization: `token ${account.accessToken}`\n          }\n        });\n        const emails = await res.json();\n\n        if (!emails || emails.length === 0) {\n          return false;\n        }\n\n        const sortedEmails = emails.sort((a, b) => b.primary - a.primary);\n        profile.email = sortedEmails[0].email;\n      }\n\n      return true;\n    },\n    jwt: async (token, user) => {\n      if (user) {\n        token.id = user.id;\n      }\n\n      return token;\n    },\n    session: async (session, user) => {\n      const dbUser = await prisma.user.findUnique({\n        where: {\n          id: user.id\n        }\n      });\n\n      if (dbUser && dbUser.role) {\n        if (!session.user) {\n          session.user = {};\n        }\n\n        session.user.role = dbUser.role;\n        session.user.id = dbUser.id;\n      }\n\n      return session;\n    }\n  },\n  session: {\n    jwt: true\n  },\n  jwt: {\n    secret: process.env.NEXT_AUTH_SECRET\n  },\n  adapter: next_auth_adapters__WEBPACK_IMPORTED_MODULE_2___default().Prisma.Adapter({\n    prisma\n  })\n}));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdLnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUEsTUFBTUssTUFBTSxHQUFHLElBQUlGLHdEQUFKLEVBQWY7QUFNQSxpRUFBZUgsZ0RBQVEsQ0FBQztFQUN0QjtFQUNBTSxTQUFTLEVBQUUsQ0FDVEwsaUVBQUEsQ0FBaUI7SUFDZk8sUUFBUSxFQUFFQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsU0FEUDtJQUVmQyxZQUFZLEVBQUVILE9BQU8sQ0FBQ0MsR0FBUixDQUFZRyxhQUZYO0lBR2ZDLEtBQUssRUFBRTtFQUhRLENBQWpCLENBRFMsRUFNVGIsc0VBQUEsQ0FBc0I7SUFDcEJlLElBQUksRUFBRSxhQURjO0lBR3BCQyxXQUFXLEVBQUU7TUFDWEMsS0FBSyxFQUFFO1FBQUVDLEtBQUssRUFBRSxPQUFUO1FBQWtCQyxJQUFJLEVBQUUsTUFBeEI7UUFBZ0NDLFdBQVcsRUFBRTtNQUE3QyxDQURJO01BRVhDLFFBQVEsRUFBRTtRQUFFSCxLQUFLLEVBQUUsVUFBVDtRQUFxQkMsSUFBSSxFQUFFO01BQTNCO0lBRkMsQ0FITzs7SUFRcEIsTUFBTUcsU0FBTixDQUFnQk4sV0FBaEIsRUFBNkJPLEdBQTdCLEVBQWtDO01BQ2hDLE1BQU1DLElBQUksR0FBRyxNQUFNckIsb0VBQWEsQ0FBQztRQUMvQmMsS0FBSyxFQUFFRCxXQUFXLENBQUNDLEtBRFk7UUFFL0JJLFFBQVEsRUFBRUwsV0FBVyxDQUFDSztNQUZTLENBQUQsQ0FBaEM7O01BS0EsSUFBSUcsSUFBSixFQUFVO1FBQ1IsT0FBTztVQUNMQyxFQUFFLEVBQUVELElBQUksQ0FBQ0MsRUFESjtVQUVMUixLQUFLLEVBQUVPLElBQUksQ0FBQ1AsS0FGUDtVQUdMUyxhQUFhLEVBQUVGLElBQUksQ0FBQ0UsYUFIZjtVQUlMWCxJQUFJLEVBQUVTLElBQUksQ0FBQ1QsSUFKTjtVQUtMWSxJQUFJLEVBQUVILElBQUksQ0FBQ0csSUFMTjtVQU1MQyxLQUFLLEVBQUVKLElBQUksQ0FBQ0ksS0FOUDtVQU9MQyxLQUFLLEVBQUVMLElBQUksQ0FBQ0ssS0FQUDtVQVFMQyxRQUFRLEVBQUVOLElBQUksQ0FBQ00sUUFSVjtVQVNMQyxPQUFPLEVBQUVQLElBQUksQ0FBQ08sT0FUVDtVQVVMQyxTQUFTLEVBQUVSLElBQUksQ0FBQ1EsU0FWWDtVQVdMQyxTQUFTLEVBQUVULElBQUksQ0FBQ1M7UUFYWCxDQUFQO01BYUQsQ0FkRCxNQWNPO1FBQ0wsT0FBTyxJQUFQO01BQ0Q7SUFDRjs7RUEvQm1CLENBQXRCLENBTlMsQ0FGVztFQTJDdEJDLFNBQVMsRUFBRTtJQUNUQyxNQUFNLEVBQUUsT0FBT0MsT0FBUCxFQUFnQkMsT0FBaEIsS0FBNEI7TUFDbEMsSUFBSUEsT0FBTyxFQUFFQyxRQUFULEtBQXNCLFFBQTFCLEVBQW9DO1FBQ2xDLE1BQU1DLEdBQUcsR0FBRyxNQUFNQyxLQUFLLENBQUMsb0NBQUQsRUFBdUM7VUFDNURDLE9BQU8sRUFBRTtZQUNQQyxhQUFhLEVBQUcsU0FBUUwsT0FBTyxDQUFDTSxXQUFZO1VBRHJDO1FBRG1ELENBQXZDLENBQXZCO1FBS0EsTUFBTUMsTUFBTSxHQUFHLE1BQU1MLEdBQUcsQ0FBQ00sSUFBSixFQUFyQjs7UUFDQSxJQUFJLENBQUNELE1BQUQsSUFBV0EsTUFBTSxDQUFDRSxNQUFQLEtBQWtCLENBQWpDLEVBQW9DO1VBQ2xDLE9BQU8sS0FBUDtRQUNEOztRQUNELE1BQU1DLFlBQVksR0FBR0gsTUFBTSxDQUFDSSxJQUFQLENBQ25CLENBQUNDLENBQUQsRUFBeUJDLENBQXpCLEtBQ0VBLENBQUMsQ0FBQ0MsT0FBRixHQUFZRixDQUFDLENBQUNFLE9BRkcsQ0FBckI7UUFJQWYsT0FBTyxDQUFDbkIsS0FBUixHQUFnQjhCLFlBQVksQ0FBQyxDQUFELENBQVosQ0FBZ0I5QixLQUFoQztNQUNEOztNQUVELE9BQU8sSUFBUDtJQUNELENBcEJRO0lBcUJUbUMsR0FBRyxFQUFFLE9BQU9DLEtBQVAsRUFBYzdCLElBQWQsS0FBdUI7TUFDMUIsSUFBSUEsSUFBSixFQUFVO1FBQ1I2QixLQUFLLENBQUM1QixFQUFOLEdBQVdELElBQUksQ0FBQ0MsRUFBaEI7TUFDRDs7TUFDRCxPQUFPNEIsS0FBUDtJQUNELENBMUJRO0lBMkJUQyxPQUFPLEVBQUUsT0FBT0EsT0FBUCxFQUFnQjlCLElBQWhCLEtBQWlDO01BQ3hDLE1BQU0rQixNQUFNLEdBQUcsTUFBTW5ELE1BQU0sQ0FBQ29CLElBQVAsQ0FBWWdDLFVBQVosQ0FBdUI7UUFBRUMsS0FBSyxFQUFFO1VBQUVoQyxFQUFFLEVBQUVELElBQUksQ0FBQ0M7UUFBWDtNQUFULENBQXZCLENBQXJCOztNQUVBLElBQUk4QixNQUFNLElBQUlBLE1BQU0sQ0FBQzVCLElBQXJCLEVBQTJCO1FBQ3pCLElBQUksQ0FBQzJCLE9BQU8sQ0FBQzlCLElBQWIsRUFBbUI7VUFDakI4QixPQUFPLENBQUM5QixJQUFSLEdBQWUsRUFBZjtRQUNEOztRQUNBOEIsT0FBTyxDQUFDOUIsSUFBVCxDQUFzQkcsSUFBdEIsR0FBNkI0QixNQUFNLENBQUM1QixJQUFwQztRQUNDMkIsT0FBTyxDQUFDOUIsSUFBVCxDQUFzQkMsRUFBdEIsR0FBMkI4QixNQUFNLENBQUM5QixFQUFsQztNQUNEOztNQUVELE9BQU82QixPQUFQO0lBQ0Q7RUF2Q1EsQ0EzQ1c7RUFxRnRCQSxPQUFPLEVBQUU7SUFDUEYsR0FBRyxFQUFFO0VBREUsQ0FyRmE7RUF3RnRCQSxHQUFHLEVBQUU7SUFDSE0sTUFBTSxFQUFFbEQsT0FBTyxDQUFDQyxHQUFSLENBQVlrRDtFQURqQixDQXhGaUI7RUE0RnRCQyxPQUFPLEVBQUUzRCx3RUFBQSxDQUF3QjtJQUFFRztFQUFGLENBQXhCO0FBNUZhLENBQUQsQ0FBdkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9NYWtlci8uL3BhZ2VzL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0udHM/MmU4YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTmV4dEF1dGggZnJvbSBcIm5leHQtYXV0aFwiO1xuaW1wb3J0IFByb3ZpZGVycyBmcm9tIFwibmV4dC1hdXRoL3Byb3ZpZGVyc1wiO1xuaW1wb3J0IEFkYXB0ZXJzIGZyb20gXCJuZXh0LWF1dGgvYWRhcHRlcnNcIjtcbmltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiO1xuaW1wb3J0IGF1dGhvcml6ZVVzZXIgZnJvbSBcInNlcnZpY2VzL3VzZXJzL2F1dGhvcml6ZVwiO1xuXG5jb25zdCBwcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KCk7XG5cbnR5cGUgVXNlcklkID0ge1xuICBpZDogbnVtYmVyIHwgdW5kZWZpbmVkO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgTmV4dEF1dGgoe1xuICAvLyBDb25maWd1cmUgb25lIG9yIG1vcmUgYXV0aGVudGljYXRpb24gcHJvdmlkZXJzXG4gIHByb3ZpZGVyczogW1xuICAgIFByb3ZpZGVycy5HaXRIdWIoe1xuICAgICAgY2xpZW50SWQ6IHByb2Nlc3MuZW52LkdJVEhVQl9JRCxcbiAgICAgIGNsaWVudFNlY3JldDogcHJvY2Vzcy5lbnYuR0lUSFVCX1NFQ1JFVCxcbiAgICAgIHNjb3BlOiBcInJlYWQ6dXNlciwgdXNlcjplbWFpbFwiLFxuICAgIH0pLFxuICAgIFByb3ZpZGVycy5DcmVkZW50aWFscyh7XG4gICAgICBuYW1lOiBcIkNyZWRlbnRpYWxzXCIsXG5cbiAgICAgIGNyZWRlbnRpYWxzOiB7XG4gICAgICAgIGVtYWlsOiB7IGxhYmVsOiBcIkVtYWlsXCIsIHR5cGU6IFwidGV4dFwiLCBwbGFjZWhvbGRlcjogXCJqc21pdGhcIiB9LFxuICAgICAgICBwYXNzd29yZDogeyBsYWJlbDogXCJQYXNzd29yZFwiLCB0eXBlOiBcInBhc3N3b3JkXCIgfSxcbiAgICAgIH0sXG5cbiAgICAgIGFzeW5jIGF1dGhvcml6ZShjcmVkZW50aWFscywgcmVxKSB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhdXRob3JpemVVc2VyKHtcbiAgICAgICAgICBlbWFpbDogY3JlZGVudGlhbHMuZW1haWwsXG4gICAgICAgICAgcGFzc3dvcmQ6IGNyZWRlbnRpYWxzLnBhc3N3b3JkLFxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgICAgcm9sZTogdXNlci5yb2xlLFxuICAgICAgICAgICAgaW1hZ2U6IHVzZXIuaW1hZ2UsXG4gICAgICAgICAgICBza2lsbDogdXNlci5za2lsbCxcbiAgICAgICAgICAgIHRpbWV6b25lOiB1c2VyLnRpbWV6b25lLFxuICAgICAgICAgICAgYmlvZ3JhbTogdXNlci5iaW9ncmFtLFxuICAgICAgICAgICAgY3JlYXRlZEF0OiB1c2VyLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogdXNlci51cGRhdGVkQXQsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9KSxcbiAgXSxcblxuICBjYWxsYmFja3M6IHtcbiAgICBzaWduSW46IGFzeW5jIChwcm9maWxlLCBhY2NvdW50KSA9PiB7XG4gICAgICBpZiAoYWNjb3VudD8ucHJvdmlkZXIgPT09IFwiZ2l0aHViXCIpIHtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goXCJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXIvZW1haWxzXCIsIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgdG9rZW4gJHthY2NvdW50LmFjY2Vzc1Rva2VufWAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGVtYWlscyA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgICAgIGlmICghZW1haWxzIHx8IGVtYWlscy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc29ydGVkRW1haWxzID0gZW1haWxzLnNvcnQoXG4gICAgICAgICAgKGE6IHsgcHJpbWFyeTogbnVtYmVyIH0sIGI6IHsgcHJpbWFyeTogbnVtYmVyIH0pID0+XG4gICAgICAgICAgICBiLnByaW1hcnkgLSBhLnByaW1hcnlcbiAgICAgICAgKTtcbiAgICAgICAgcHJvZmlsZS5lbWFpbCA9IHNvcnRlZEVtYWlsc1swXS5lbWFpbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBqd3Q6IGFzeW5jICh0b2tlbiwgdXNlcikgPT4ge1xuICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgdG9rZW4uaWQgPSB1c2VyLmlkO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRva2VuO1xuICAgIH0sXG4gICAgc2Vzc2lvbjogYXN5bmMgKHNlc3Npb24sIHVzZXI6IFVzZXJJZCkgPT4ge1xuICAgICAgY29uc3QgZGJVc2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGlkOiB1c2VyLmlkIH0gfSk7XG5cbiAgICAgIGlmIChkYlVzZXIgJiYgZGJVc2VyLnJvbGUpIHtcbiAgICAgICAgaWYgKCFzZXNzaW9uLnVzZXIpIHtcbiAgICAgICAgICBzZXNzaW9uLnVzZXIgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICAoc2Vzc2lvbi51c2VyIGFzIGFueSkucm9sZSA9IGRiVXNlci5yb2xlO1xuICAgICAgICAoc2Vzc2lvbi51c2VyIGFzIGFueSkuaWQgPSBkYlVzZXIuaWQ7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzZXNzaW9uO1xuICAgIH0sXG4gIH0sXG5cbiAgc2Vzc2lvbjoge1xuICAgIGp3dDogdHJ1ZSxcbiAgfSxcbiAgand0OiB7XG4gICAgc2VjcmV0OiBwcm9jZXNzLmVudi5ORVhUX0FVVEhfU0VDUkVULFxuICB9LFxuXG4gIGFkYXB0ZXI6IEFkYXB0ZXJzLlByaXNtYS5BZGFwdGVyKHsgcHJpc21hIH0pLFxufSk7XG4iXSwibmFtZXMiOlsiTmV4dEF1dGgiLCJQcm92aWRlcnMiLCJBZGFwdGVycyIsIlByaXNtYUNsaWVudCIsImF1dGhvcml6ZVVzZXIiLCJwcmlzbWEiLCJwcm92aWRlcnMiLCJHaXRIdWIiLCJjbGllbnRJZCIsInByb2Nlc3MiLCJlbnYiLCJHSVRIVUJfSUQiLCJjbGllbnRTZWNyZXQiLCJHSVRIVUJfU0VDUkVUIiwic2NvcGUiLCJDcmVkZW50aWFscyIsIm5hbWUiLCJjcmVkZW50aWFscyIsImVtYWlsIiwibGFiZWwiLCJ0eXBlIiwicGxhY2Vob2xkZXIiLCJwYXNzd29yZCIsImF1dGhvcml6ZSIsInJlcSIsInVzZXIiLCJpZCIsImVtYWlsVmVyaWZpZWQiLCJyb2xlIiwiaW1hZ2UiLCJza2lsbCIsInRpbWV6b25lIiwiYmlvZ3JhbSIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsImNhbGxiYWNrcyIsInNpZ25JbiIsInByb2ZpbGUiLCJhY2NvdW50IiwicHJvdmlkZXIiLCJyZXMiLCJmZXRjaCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwiYWNjZXNzVG9rZW4iLCJlbWFpbHMiLCJqc29uIiwibGVuZ3RoIiwic29ydGVkRW1haWxzIiwic29ydCIsImEiLCJiIiwicHJpbWFyeSIsImp3dCIsInRva2VuIiwic2Vzc2lvbiIsImRiVXNlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsInNlY3JldCIsIk5FWFRfQVVUSF9TRUNSRVQiLCJhZGFwdGVyIiwiUHJpc21hIiwiQWRhcHRlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/auth/[...nextauth].ts\n");

/***/ }),

/***/ "(api)/./services/users/authorize.ts":
/*!*************************************!*\
  !*** ./services/users/authorize.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var models__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! models */ \"(api)/./models/index.ts\");\n/* harmony import */ var joi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! joi */ \"joi\");\n/* harmony import */ var joi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(joi__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nconst schema = joi__WEBPACK_IMPORTED_MODULE_1___default().object({\n  email: joi__WEBPACK_IMPORTED_MODULE_1___default().string().email().required(),\n  password: joi__WEBPACK_IMPORTED_MODULE_1___default().string().required()\n});\n\nconst authorizeUser = async payload => {\n  const {\n    email,\n    password\n  } = await schema.validateAsync(payload);\n\n  if (typeof email !== \"string\" || !email) {\n    throw new Error(\"Invalid email\");\n  }\n\n  const existingUser = await models__WEBPACK_IMPORTED_MODULE_0__.user.findUnique({\n    where: {\n      email: email.toLocaleLowerCase()\n    }\n  });\n\n  if (!existingUser) {\n    return null;\n  }\n\n  if (!existingUser.passwordSalt) {\n    return null;\n  }\n\n  const passwordHash = crypto__WEBPACK_IMPORTED_MODULE_2___default().pbkdf2Sync(password, existingUser.passwordSalt, 1000, 64, `sha512`).toString(\"hex\");\n\n  if (passwordHash !== existingUser.passwordHash) {\n    return null;\n  }\n\n  return {\n    id: existingUser.id,\n    email: existingUser.email,\n    emailVerified: existingUser.emailVerified,\n    name: existingUser.name,\n    role: existingUser.role,\n    banned: existingUser.banned,\n    image: existingUser.image,\n    skill: existingUser.skill,\n    timezone: existingUser.timezone,\n    biogram: existingUser.biogram,\n    createdAt: existingUser.createdAt,\n    updatedAt: existingUser.updatedAt\n  };\n};\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (authorizeUser);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zZXJ2aWNlcy91c2Vycy9hdXRob3JpemUudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBUUEsTUFBTUksTUFBTSxHQUFHRixpREFBQSxDQUE0QjtFQUN6Q0ksS0FBSyxFQUFFSixpREFBQSxHQUFhSSxLQUFiLEdBQXFCRSxRQUFyQixFQURrQztFQUV6Q0MsUUFBUSxFQUFFUCxpREFBQSxHQUFhTSxRQUFiO0FBRitCLENBQTVCLENBQWY7O0FBS0EsTUFBTUUsYUFBYSxHQUFHLE1BQ3BCQyxPQURvQixJQUVVO0VBQzlCLE1BQU07SUFBRUwsS0FBRjtJQUFTRztFQUFULElBQXNCLE1BQU1MLE1BQU0sQ0FBQ1EsYUFBUCxDQUFxQkQsT0FBckIsQ0FBbEM7O0VBRUEsSUFBSSxPQUFPTCxLQUFQLEtBQWlCLFFBQWpCLElBQTZCLENBQUNBLEtBQWxDLEVBQXlDO0lBQ3ZDLE1BQU0sSUFBSU8sS0FBSixDQUFVLGVBQVYsQ0FBTjtFQUNEOztFQUVELE1BQU1DLFlBQVksR0FBRyxNQUFNYixtREFBQSxDQUFxQjtJQUM5Q2UsS0FBSyxFQUFFO01BQ0xWLEtBQUssRUFBRUEsS0FBSyxDQUFDVyxpQkFBTjtJQURGO0VBRHVDLENBQXJCLENBQTNCOztFQU1BLElBQUksQ0FBQ0gsWUFBTCxFQUFtQjtJQUNqQixPQUFPLElBQVA7RUFDRDs7RUFFRCxJQUFJLENBQUNBLFlBQVksQ0FBQ0ksWUFBbEIsRUFBZ0M7SUFDOUIsT0FBTyxJQUFQO0VBQ0Q7O0VBRUQsTUFBTUMsWUFBWSxHQUFHaEIsd0RBQUEsQ0FDUE0sUUFETyxFQUNHSyxZQUFZLENBQUNJLFlBRGhCLEVBQzhCLElBRDlCLEVBQ29DLEVBRHBDLEVBQ3lDLFFBRHpDLEVBRWxCRyxRQUZrQixDQUVULEtBRlMsQ0FBckI7O0VBSUEsSUFBSUYsWUFBWSxLQUFLTCxZQUFZLENBQUNLLFlBQWxDLEVBQWdEO0lBQzlDLE9BQU8sSUFBUDtFQUNEOztFQUVELE9BQU87SUFDTEcsRUFBRSxFQUFFUixZQUFZLENBQUNRLEVBRFo7SUFFTGhCLEtBQUssRUFBRVEsWUFBWSxDQUFDUixLQUZmO0lBR0xpQixhQUFhLEVBQUVULFlBQVksQ0FBQ1MsYUFIdkI7SUFJTEMsSUFBSSxFQUFFVixZQUFZLENBQUNVLElBSmQ7SUFLTEMsSUFBSSxFQUFFWCxZQUFZLENBQUNXLElBTGQ7SUFNTEMsTUFBTSxFQUFFWixZQUFZLENBQUNZLE1BTmhCO0lBT0xDLEtBQUssRUFBRWIsWUFBWSxDQUFDYSxLQVBmO0lBUUxDLEtBQUssRUFBRWQsWUFBWSxDQUFDYyxLQVJmO0lBU0xDLFFBQVEsRUFBRWYsWUFBWSxDQUFDZSxRQVRsQjtJQVVMQyxPQUFPLEVBQUVoQixZQUFZLENBQUNnQixPQVZqQjtJQVdMQyxTQUFTLEVBQUVqQixZQUFZLENBQUNpQixTQVhuQjtJQVlMQyxTQUFTLEVBQUVsQixZQUFZLENBQUNrQjtFQVpuQixDQUFQO0FBY0QsQ0E3Q0Q7O0FBK0NBLGlFQUFldEIsYUFBZiIsInNvdXJjZXMiOlsid2VicGFjazovL01ha2VyLy4vc2VydmljZXMvdXNlcnMvYXV0aG9yaXplLnRzP2VmMmMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlciBhcyB1c2VyTW9kZWwgfSBmcm9tIFwibW9kZWxzXCI7XG5pbXBvcnQgSm9pIGZyb20gXCJqb2lcIjtcbmltcG9ydCBjcnlwdG8gZnJvbSBcImNyeXB0b1wiO1xuaW1wb3J0IHsgSU5leHRVc2VyIH0gZnJvbSBcInR5cGVzL3R5cGVzXCI7XG5cbmludGVyZmFjZSBBdXRob3JpemVTY2hlbWEge1xuICBlbWFpbDogc3RyaW5nO1xuICBwYXNzd29yZDogc3RyaW5nO1xufVxuXG5jb25zdCBzY2hlbWEgPSBKb2kub2JqZWN0PEF1dGhvcml6ZVNjaGVtYT4oe1xuICBlbWFpbDogSm9pLnN0cmluZygpLmVtYWlsKCkucmVxdWlyZWQoKSxcbiAgcGFzc3dvcmQ6IEpvaS5zdHJpbmcoKS5yZXF1aXJlZCgpLFxufSk7XG5cbmNvbnN0IGF1dGhvcml6ZVVzZXIgPSBhc3luYyAoXG4gIHBheWxvYWQ6IEF1dGhvcml6ZVNjaGVtYVxuKTogUHJvbWlzZTxJTmV4dFVzZXIgfCBudWxsPiA9PiB7XG4gIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSBhd2FpdCBzY2hlbWEudmFsaWRhdGVBc3luYyhwYXlsb2FkKTtcblxuICBpZiAodHlwZW9mIGVtYWlsICE9PSBcInN0cmluZ1wiIHx8ICFlbWFpbCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgZW1haWxcIik7XG4gIH1cblxuICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCB1c2VyTW9kZWwuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHtcbiAgICAgIGVtYWlsOiBlbWFpbC50b0xvY2FsZUxvd2VyQ2FzZSgpLFxuICAgIH0sXG4gIH0pO1xuXG4gIGlmICghZXhpc3RpbmdVc2VyKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBpZiAoIWV4aXN0aW5nVXNlci5wYXNzd29yZFNhbHQpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNvbnN0IHBhc3N3b3JkSGFzaCA9IGNyeXB0b1xuICAgIC5wYmtkZjJTeW5jKHBhc3N3b3JkLCBleGlzdGluZ1VzZXIucGFzc3dvcmRTYWx0LCAxMDAwLCA2NCwgYHNoYTUxMmApXG4gICAgLnRvU3RyaW5nKFwiaGV4XCIpO1xuXG4gIGlmIChwYXNzd29yZEhhc2ggIT09IGV4aXN0aW5nVXNlci5wYXNzd29yZEhhc2gpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaWQ6IGV4aXN0aW5nVXNlci5pZCxcbiAgICBlbWFpbDogZXhpc3RpbmdVc2VyLmVtYWlsLFxuICAgIGVtYWlsVmVyaWZpZWQ6IGV4aXN0aW5nVXNlci5lbWFpbFZlcmlmaWVkLFxuICAgIG5hbWU6IGV4aXN0aW5nVXNlci5uYW1lLFxuICAgIHJvbGU6IGV4aXN0aW5nVXNlci5yb2xlLFxuICAgIGJhbm5lZDogZXhpc3RpbmdVc2VyLmJhbm5lZCxcbiAgICBpbWFnZTogZXhpc3RpbmdVc2VyLmltYWdlLFxuICAgIHNraWxsOiBleGlzdGluZ1VzZXIuc2tpbGwsXG4gICAgdGltZXpvbmU6IGV4aXN0aW5nVXNlci50aW1lem9uZSxcbiAgICBiaW9ncmFtOiBleGlzdGluZ1VzZXIuYmlvZ3JhbSxcbiAgICBjcmVhdGVkQXQ6IGV4aXN0aW5nVXNlci5jcmVhdGVkQXQsXG4gICAgdXBkYXRlZEF0OiBleGlzdGluZ1VzZXIudXBkYXRlZEF0LFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgYXV0aG9yaXplVXNlcjtcbiJdLCJuYW1lcyI6WyJ1c2VyIiwidXNlck1vZGVsIiwiSm9pIiwiY3J5cHRvIiwic2NoZW1hIiwib2JqZWN0IiwiZW1haWwiLCJzdHJpbmciLCJyZXF1aXJlZCIsInBhc3N3b3JkIiwiYXV0aG9yaXplVXNlciIsInBheWxvYWQiLCJ2YWxpZGF0ZUFzeW5jIiwiRXJyb3IiLCJleGlzdGluZ1VzZXIiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJ0b0xvY2FsZUxvd2VyQ2FzZSIsInBhc3N3b3JkU2FsdCIsInBhc3N3b3JkSGFzaCIsInBia2RmMlN5bmMiLCJ0b1N0cmluZyIsImlkIiwiZW1haWxWZXJpZmllZCIsIm5hbWUiLCJyb2xlIiwiYmFubmVkIiwiaW1hZ2UiLCJza2lsbCIsInRpbWV6b25lIiwiYmlvZ3JhbSIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./services/users/authorize.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/auth/[...nextauth].ts"));
module.exports = __webpack_exports__;

})();